@page "/"
@using CarRental.Business.Classes
@using CarRental.Common.Interfaces
@using CarRental.Common.Enums
@inject BookingProcessor bp

<PageTitle>Car Rental Assignment</PageTitle>

<h1>Car Rental Assignment</h1>
<div class="row">
    <h2>Customers</h2>
    <table class="table">
        <thead>
            <tr class="table-dark">
                <th scope="col">SSN</th>
                <th scope="col">First Name</th>
                <th scope="col">Last Name</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><input @bind=bp.NewCustomer.Ssn type="text" placeholder="SSN" /></td>
                <td><input @bind=bp.NewCustomer.LastName type="text" placeholder="Last Name" /></td>
                <td><input @bind=bp.NewCustomer.FirstName type="text" placeholder="First Name" />
                    <button @onclick="() => bp.HandleAddCustomer(bp.NewCustomer.Ssn, bp.NewCustomer.LastName, bp.NewCustomer.FirstName)" class="ms-3">Add</button>
                </td>
            </tr>
            @foreach (var customer in bp.GetCustomers())
            {
                <tr>
                    <th>@customer.Ssn</th>
                    <td>@customer.FirstName</td>
                    <td>@customer.LastName</td>
                </tr>
            }
        </tbody>
    </table>

</div>
<br />
<div class="row">
    <h2>Vehicles</h2>
    <table class="table">
        <thead>
            <tr class="table-dark">
                <th scope="col">RegNo</th>
                <th scope="col">Make</th>
                <th scope="col">Odometer</th>
                <th scope="col">Cost Km</th>
                <th scope="col">Vehicle Type</th>
                <th scope="col">$ Day</th>
                <th scope="col">Status</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var vehicle in bp.GetVehicles())
            {
                <tr>
                    <th>@vehicle.RegNo</th>
                    <td>@vehicle.Make</td>
                    <td>@vehicle.Odometer</td>
                    <td>@vehicle.CostPerKilometer</td>
                    <td>@vehicle.VehicleType</td>
                    <td>@vehicle.CostPerDay</td>
                    <td><span class="rounded-pill text-center text-light bg-@(vehicle.Status == VehicleStatuses.Available ? "dark" : "danger") p-2">@vehicle.Status</span></td>
                </tr>
            }
        </tbody>
    </table>
</div>
<br />
<div class="row">
    <h2>Bookings</h2>
    <table class="table">
        <thead>
            <tr class="table-dark">
                <th scope="col">RegNo</th>
                <th scope="col">Customer</th>
                <th scope="col">Km Rented</th>
                <th scope="col">Km Returned</th>
                <th scope="col">Rented</th>
                <th scope="col">Returned</th>
                <th scope="col">Cost</th>
                <th scope="col">Status</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var booking in bp.GetBookings())
            {
                <tr>
                    <th>@booking.RegNo</th>
                    <td>@($"{booking.Customer.LastName} {booking.Customer.FirstName} ({booking.Customer.Ssn})")</td>
                    <td>@booking.KmRented</td>
                    <td>@booking.KmReturned</td>
                    <td>@booking.Rented</td>
                    <td>@booking.Returned</td>
                    <td>@booking.Cost</td>
                    <td><span class="rounded-pill text-center text-light bg-@(booking.Status == "Open" ? "danger" : "success") p-2">@booking.Status</span></td>
                </tr>
            }
        </tbody>
    </table>
</div>
